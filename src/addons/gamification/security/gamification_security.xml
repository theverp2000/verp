<verp noupdate="1">

        <record id="goalUserVisibility" model="ir.rule">
            <field name="label">User can only see his/her goals or goal from the same challenge in board visibility</field>
            <field name="modelId" ref="model_gamificationGoal"/>
            <field name="groups" eval="[[4, refId('base.groupUser')], [4, refId('base.groupPortal')]]"/>
            <field name="permRead" eval="true"/>
            <field name="permWrite" eval="true"/>
            <field name="permCreate" eval="false"/>
            <field name="permUnlink" eval="false"/>
            <field name="domainForce">[
                '|',
                    ['userId','=',user.id],
                    '&amp;',
                        ['challengeId.userIds','in',user.id],
                        ['challengeId.visibilityMode','=','ranking']]</field>
        </record>

        <record id="goalGamificationManagerVisibility" model="ir.rule">
            <field name="label">Manager can see any goal</field>
            <field name="modelId" ref="model_gamificationGoal"/>
            <field name="groups" eval="[[4, refId('base.groupErpManager')]]"/>
            <field name="permRead" eval="true"/>
            <field name="permWrite" eval="true"/>
            <field name="permCreate" eval="false"/>
            <field name="permUnlink" eval="false"/>
            <field name="domainForce">[[1, '=', 1]]</field>
        </record>

        <record id="goalGlobalMulticompany" model="ir.rule">
            <field name="label">Multicompany rule on challenges</field>
            <field name="modelId" ref="model_gamificationGoal"/>
            <field name="domainForce">[['userId.companyId', 'in', companyIds]]</field>
        </record>

</verp>
